<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Anand Krishnakumar" />

<meta name="date" content="2018-12-19" />

<title>Run-times for attribution analysis</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Run-times for attribution analysis</h1>
<h4 class="author"><em><a href="https://github.com/anandkkumar">Anand Krishnakumar</a></em></h4>
<h4 class="date"><em>2018-12-19</em></h4>



<p>This vignette demonstrates how to measure the computation times on a large data set of portfolio &amp; benchmark weights and returns. It is intended to be illustrative and does not represent a rigorous approach to benchmarking the performance of the functions. The <code>system.time</code> command is employed and the results will naturally vary based on your computing platform.</p>
<div id="define-the-data-inputs" class="section level3">
<h3><ins>Define the data inputs</ins></h3>
<p>Say we have two relatively large portfolio &amp; benchmark data sets at the security level. This first example in the data set in the package has 2958 assets over 13 monthly periods and the second example in the data set has 13356 assets over 159 monthly periods. The column names are security identifiers and the row indexes are month-end dates.</p>
<p>The first few periods &amp; assets are shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(PortfolioAttribution)
<span class="kw">data</span>(<span class="st">&quot;sample_data&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;PortfolioAttribution&quot;</span>)
<span class="co"># Portfolio 1 weights</span>
multi_period_portf_<span class="dv">1</span><span class="op">$</span>wp[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt;            20 58     127 182 316</span>
<span class="co">#&gt; 2017-01-31  0  0 0.00859   0   0</span>
<span class="co">#&gt; 2017-02-28  0  0 0.00940   0   0</span>
<span class="co">#&gt; 2017-03-31  0  0 0.00864   0   0</span>

<span class="co"># Portfolio 1 returns</span>
multi_period_portf_<span class="dv">1</span><span class="op">$</span>Rp[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt;            20 58          127 182 316</span>
<span class="co">#&gt; 2017-02-28  0  0  0.064429424   0   0</span>
<span class="co">#&gt; 2017-03-31  0  0  0.059282159   0   0</span>
<span class="co">#&gt; 2017-04-30  0  0 -0.007982311   0   0</span>

<span class="co"># Benchmark 1 weights</span>
multi_period_portf_<span class="dv">1</span><span class="op">$</span>wb[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt;                      20           58          127          182</span>
<span class="co">#&gt; 2017-01-31 5.771383e-05 1.011494e-04 0.0001655827 0.0001824139</span>
<span class="co">#&gt; 2017-02-28 6.804004e-05 9.097493e-05 0.0001705980 0.0001791925</span>
<span class="co">#&gt; 2017-03-31 6.161553e-05 8.986991e-05 0.0001765198 0.0001945415</span>
<span class="co">#&gt;                     316</span>
<span class="co">#&gt; 2017-01-31 9.592707e-05</span>
<span class="co">#&gt; 2017-02-28 8.996689e-05</span>
<span class="co">#&gt; 2017-03-31 8.174214e-05</span>

<span class="co"># Benchmark 1 returns</span>
multi_period_portf_<span class="dv">1</span><span class="op">$</span>Rb[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt;                     20          58          127        182         316</span>
<span class="co">#&gt; 2017-02-28  0.21798643 -0.07078516  0.064429424 0.01489157 -0.03105446</span>
<span class="co">#&gt; 2017-03-31 -0.07291892  0.01131084  0.059282159 0.10765125 -0.06984499</span>
<span class="co">#&gt; 2017-04-30 -0.08703840  0.05988152 -0.007982311 0.29510731 -0.09079932</span>

<span class="co"># Portfolio 2 weights</span>
multi_period_portf_<span class="dv">3</span><span class="op">$</span>wp[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt;            20 24 27 31          33</span>
<span class="co">#&gt; 2004-12-31  0  0  0  0 0.002622551</span>
<span class="co">#&gt; 2005-01-31  0  0  0  0 0.002538119</span>
<span class="co">#&gt; 2005-02-28  0  0  0  0 0.002829017</span>

<span class="co"># Portfolio 2 returns</span>
multi_period_portf_<span class="dv">3</span><span class="op">$</span>Rp[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt;            20 24 27 31         33</span>
<span class="co">#&gt; 2005-01-31  0  0  0  0 -0.0272352</span>
<span class="co">#&gt; 2005-02-28  0  0  0  0  0.1833933</span>
<span class="co">#&gt; 2005-03-31  0  0  0  0 -0.0605333</span>

<span class="co"># Benchmark 2 weights</span>
multi_period_portf_<span class="dv">3</span><span class="op">$</span>wb[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt;                      20 24          27           31           33</span>
<span class="co">#&gt; 2004-12-31 4.560282e-05  0 0.002823767 5.620691e-05 0.0003968976</span>
<span class="co">#&gt; 2005-01-31 4.131186e-05  0 0.002725027 6.065969e-05 0.0003904902</span>
<span class="co">#&gt; 2005-02-28 4.294411e-05  0 0.003010767 6.464620e-05 0.0004419863</span>

<span class="co"># Benchmark 2 returns</span>
multi_period_portf_<span class="dv">3</span><span class="op">$</span>Rb[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
<span class="co">#&gt;                     20 24          27         31         33</span>
<span class="co">#&gt; 2005-01-31 -0.10972479  0 -0.04180527  0.0576820 -0.0272352</span>
<span class="co">#&gt; 2005-02-28  0.08374601  0  0.15619466  0.1148176  0.1833933</span>
<span class="co">#&gt; 2005-03-31 -0.11210577  0  0.03713810 -0.1720133 -0.0605333</span></code></pre></div>
</div>
<div id="run-time-analysis" class="section level3">
<h3><ins>Run-time analysis</ins></h3>
<p>The following command is executed to run &amp; time a multi-period arithmetic attribution analysis using the default <em>Brinson and Fachler <span class="citation">(1985)</span></em> model and adopting a top-down approach with the default smoothing algorithm of <em>GRAP <span class="citation">(1997)</span></em> on the first example data set (please refer to the <a href="multi-period-arithmetic.html">multi-period arithmetic attribution vignette</a> for more details on smoothing).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">Attribution</span>(multi_period_portf_<span class="dv">1</span><span class="op">$</span>Rp, multi_period_portf_<span class="dv">1</span><span class="op">$</span>wp, 
                        multi_period_portf_<span class="dv">1</span><span class="op">$</span>Rb, multi_period_portf_<span class="dv">1</span><span class="op">$</span>wb, 
                        <span class="dt">method =</span> <span class="st">&quot;top.down&quot;</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    0.45    0.01    0.56</span></code></pre></div>
<p>The following command is executed to run &amp; time a multi-period geometric attribution analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">Attribution</span>(multi_period_portf_<span class="dv">1</span><span class="op">$</span>Rp, multi_period_portf_<span class="dv">1</span><span class="op">$</span>wp, 
                        multi_period_portf_<span class="dv">1</span><span class="op">$</span>Rb, multi_period_portf_<span class="dv">1</span><span class="op">$</span>wb, 
                        <span class="dt">geometric =</span> <span class="ot">TRUE</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    0.14    0.02    0.20</span></code></pre></div>
<p>The following command is executed to run &amp; time a multi-period arithmetic attribution analysis using the default <em>Brinson and Fachler <span class="citation">(1985)</span></em> model and adopting a top-down approach with the default smoothing algorithm of <em>GRAP <span class="citation">(1997)</span></em> on the second example data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">Attribution</span>(multi_period_portf_<span class="dv">3</span><span class="op">$</span>Rp, multi_period_portf_<span class="dv">3</span><span class="op">$</span>wp, 
                        multi_period_portf_<span class="dv">3</span><span class="op">$</span>Rb, multi_period_portf_<span class="dv">3</span><span class="op">$</span>wb, 
                        <span class="dt">method =</span> <span class="st">&quot;top.down&quot;</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    5.60    0.60    6.33</span></code></pre></div>
<p>The following command is executed to run &amp; time a multi-period geometric attribution analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">Attribution</span>(multi_period_portf_<span class="dv">3</span><span class="op">$</span>Rp, multi_period_portf_<span class="dv">3</span><span class="op">$</span>wp, 
                        multi_period_portf_<span class="dv">3</span><span class="op">$</span>Rb, multi_period_portf_<span class="dv">3</span><span class="op">$</span>wb, 
                        <span class="dt">geometric =</span> <span class="ot">TRUE</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    2.78    0.27    3.13</span></code></pre></div>
<p>In general,</p>
<ul>
<li>the arithmetic attribution analysis takes longer than the geometric attribution analysis largely due to the need for computing smoothed effects for <em>each</em> period to arrive at the total effects for arithmetic attribution</li>
<li>the longer the analysis period, the longer it takes to do the attribution analysis</li>
</ul>
</div>
<div id="references" class="section level3 unnumbered">
<h3><ins>References</ins></h3>
<div id="refs" class="references">
<div id="ref-brinson1985measuring">
<p>Brinson, Gary P, and Nimrod Fachler. 1985. “Measuring Non-Us. Equity Portfolio Performance.” <em>The Journal of Portfolio Management</em> 11 (3). Institutional Investor Journals: 73–76.</p>
</div>
<div id="ref-grap1997">
<p>GRAP, (Groupe de Recherche en Attribution de Performance). 1997. “Synthese Des Modeles d’attribution de Performance.” <em>Journal of Performance Measurement</em>. Paris, Mars.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
